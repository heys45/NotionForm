async function handleSubmit(event) {
  event.preventDefault();
  const form = document.getElementsByTagName("form")[0];
  const formData = new FormData(form);
  const data = {};
  for (const [key, value] of formData.entries()) {
    if (value !== "") {
      data[key] = value;
    }
  }

  const tagContainer = document.getElementById("タグ-container");
  const selectedTags = Array.from(
    tagContainer.querySelectorAll(".selected")
  ).map((button) => button.textContent);

  const tagInputs = Array.from(
    tagContainer.querySelectorAll(".tag-input")
  );
  const tagInputValues = tagInputs
    .map((input) => input.value.trim())
    .filter((value) => value !== "");

  const allTags = selectedTags.concat(tagInputValues);

  // タグデータがある場合だけ、dataオブジェクトに追加
  if (allTags.length > 0) {
    data["タグ"] = JSON.stringify(allTags);
  }

  const response = await fetch("https://script.google.com/macros/s/AKfycbwUHrw95OqVOt379tLKguyaAVFSyeK8k9anfl0xnrECQtpQXzx6zRyleHJkJwpvCR_QNQ/exec", {
    method: 'POST',
    headers: {
      'Content-Type': 'text/plain',
    },
    body: JSON.stringify(data),
    mode: 'cors',
  });

  const text = await response.text();
  if (text.includes("Success")) {
    console.log('データが正常に送信されました');
    form.reset();
    fetchFormData();
  } else {
    console.error(`エラーメッセージ: ${text}`);
  }
};
