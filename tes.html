
<script>
// フォームのHTMLを生成する関数
function generateForm() {
  var form = document.createElement('form');
  form.setAttribute('id', 'my-form');
  form.setAttribute('action', 'https://script.google.com/macros/s/your_script_id/exec');
  form.setAttribute('method', 'POST');

  var taskLabel = document.createElement('label');
  taskLabel.textContent = 'タスク内容';

  var taskSelect = document.createElement('select');
  taskSelect.setAttribute('name', 'task');

  var taskData = [
    { value: 'task1', label: 'タスク1' },
    { value: 'task2', label: 'タスク2' },
    { value: 'task3', label: 'タスク3' }
  ];

  taskData.forEach(function (data) {
    var option = document.createElement('option');
    option.setAttribute('value', data.value);
    option.textContent = data.label;
    taskSelect.appendChild(option);
  });

  var submitBtn = document.createElement('button');
  submitBtn.setAttribute('type', 'submit');
  submitBtn.textContent = '送信';

  form.appendChild(taskLabel);
  form.appendChild(taskSelect);
  form.appendChild(submitBtn);

  document.body.appendChild(form);
}

// ページが読み込まれたらフォームを生成する
window.onload = function () {
  generateForm();
};





<table>
  <tbody>
    <tr>
      <th>タスク内容</th>
      <th>見積</th>
      <th>実工数</th>
      <th>進捗</th>
      <th>Task Detail</th>
      <th>クライアント</th>
      <th>作成日時</th>
    </tr>
    <tr>
      <td>タスク内容</td>
      <td>10</td>
      <td>5</td>
      <td>50</td>
      <td>このタスクは...</td>
      <td>A社</td>
      <td>2023/4/10 15:33:00</td>
    </tr>
    <tr>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>トモノカイ</td>
      <td>2023/4/7 21:47:00</td>
    </tr>
    <tr>
      <td>原口さんへ進捗報告</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>トモノカイ</td>
      <td>2023/4/7 15:59:00</td>
    </tr>
    <tr>
      <td>相談事項</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>トモノカイ</td>
      <td>2023/4/7 10:37:00</td>
    </tr>
    <tr>
      <td>システム周り要件整理</td>
      <td>null</td>
      <td>120</td>
      <td>null</td>
      <td>4/6 定例(原口さん)

        4/4 定例(原口さん、足立さん)
      </td>
      <td>トモノカイ</td>
      <td>2023/4/7 8:50:00</td>
    </tr>
    <tr>
      <td>個別エラー対応</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>トモノカイ</td>
      <td>2023/4/7 8:48:00</td>
    </tr>
    <tr>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>トモノカイ</td>
      <td>2023/4/6 21:46:00</td>
    </tr>
    <tr>
      <td>DB作成シナリオ修正</td>
      <td>400</td>
      <td>360</td>
      <td>null</td>
      <td>4/5 重複プロパティの削除、選考管理DB作成シナリオ再構築、塩沢さんへのヒアリング準備
        4/6 選考管理作成シナリオの修正(90)
        4/7 講師DB、教室DBのシナリオ修正(120)</td>
      <td>トモノカイ</td>
      <td>2023/4/5 9:25:00</td>
    </tr>
    <tr>
      <td>西澤さんフォロー</td>
      <td>420</td>
      <td>90</td>
      <td>20</td>
      <td>- ココナラやり取り30
        - ココナラMTG 90
        - MTG後開発環境構築など 60</td>
      <td>トモノカイ</td>
      <td>2023/4/5 9:21:00</td>
    </tr>
    <tr>
      <td>システム改修ココナラ発注</td>
      <td>600</td>
      <td>60</td>
      <td>20</td>
      <td>- 発注andメッセージやりとり。すぷ氏のウェブ出力ができそう？？</td>
      <td>トモノカイ</td>
      <td>2023/4/5 9:21:00</td>
    </tr>
    <tr>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>SYN_Group</td>
      <td>2023/3/28 20:46:00</td>
    </tr>
    <tr>
      <td>事業承継起業塾リサーチ</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>河村さん</td>
      <td>2023/3/24 16:36:00</td>
    </tr>
    <tr>
      <td>タスク/スケジュールinput作り</td>
      <td>120</td>
      <td>null</td>
      <td>null</td>
      <td>null</td>
      <td>SAUCEED</td>
      <td>2023/3/24 15:22:00</td>
    </tr>
  </tbody>
</table>

上記のような表があります。この時、下記のようにフォームがあるのですが、フォームでは、タスク内容を上記の表データから選択するようにしたいです。可能なら選択せずに、任意のテキストを入力することもできるようにしたいです。下記のフォームのHTMLと、フォームをコントロールするjsスクリプトを作成してください。


<form id="myForm">
        <label for="title">タスク内容:</label><br>
        <input type="text" id="title" name="title"><br>
        <label for="estimation">見積:</label><br>
        <input type="number" id="estimation" name="number:見積"><br>
        <label for="actual">実工数:</label><br>
        <input type="number" id="actual" name="number:実工数"><br>
        <label for="progress">進捗:</label><br>
        <input type="number" id="progress" name="number:進捗"><br>
        <label for="taskDetail">Task Detail:</label><br>
        <input type="text" id="taskDetail" name="rich text:Task Detail"><br>
        <label for="client">クライアント:</label><br>
        <select id="client" name="select:クライアント">
          <option value="A社">A社</option>
          <option value="B社">B社</option>
          <option value="C社">C社</option>
        </select><br><br>
        <input type="submit" value="送信">
      </form>

<script>
        // フォームの送信をハンドルする関数
        const handleSubmit = async (event) => {
          event.preventDefault(); // デフォルトの送信をキャンセル
          const form = document.querySelector('#myForm');
          const formData = new FormData(form);
          const data = {};
          // FormDataオブジェクトから連想配列に変換
          for (const [key, value] of formData.entries()) {
            data[key] = value;
          }


        // taskDetailを整形してdataに追加
        const now = new Date();
        const formattedDate = now.getFullYear() + "-" + (now.getMonth() + 1) + "-" + now.getDate();
        const formattedTime = now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
        const taskDetail = data["rich text:Task Detail"];
        const actual = data["number:実工数"];
        const formattedTaskDetail = `${actual} ${formattedDate} ${formattedTime}\n${taskDetail}`;
        data["rich text:Task Detail"] = formattedTaskDetail;

        const response = await fetch("https://script.google.com/macros/s/AKfycbyZQosu3WeC4dq-SWiU2yOrTJr1Gjea6s4EvjlfzuFKpADlPdTCojiENHreCnN5Nn86/exec", {
        method: 'POST',
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded' // Content-Typeヘッダーを設定
        },
        body: Object.keys(data).map(key => encodeURIComponent(key) + '=' + encodeURIComponent(data[key])).join('&')
        });
          if (response.ok) {
            console.log('データが正常に送信されました');
            form.reset(); // フォームの入力値をリセット
          } else {
            console.log('データの送信に失敗しました');
          }
        };
        const form = document.querySelector('#myForm');
        form.addEventListener('submit', handleSubmit);
      </script>